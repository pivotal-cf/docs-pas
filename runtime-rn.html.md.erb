---
title: TAS for VMs v6.0 Release notes
owner: Release Engineering
---

These are the release notes for <%= vars.app_runtime_first %> <%= vars.v_major_version %>.

<%= vars.app_runtime_abbr %> is certified by the Cloud Foundry Foundation for 2023.

For more information about the Cloud Foundry Certified Provider Program, see [How Do I Become a Certified
Provider?](https://www.cloudfoundry.org/certified-platforms-how-to/) on the Cloud Foundry website.

Because VMware uses the Percona Distribution for MySQL, expect a time lag between Oracle releasing a MySQL patch and VMware releasing
<%= vars.app_runtime_abbr %> containing that patch.

<hr>

## <a id='releases'></a> Releases

### <a id='6.0.0'></a> 6.0.0

**Release Date:** 04/09/2024

* **[Breaking Change]** Remove Portal from TAS
* **[Breaking Change]** Change default internal route service port to 7070
* **[Breaking Change]** No longer install cflinuxfs3 by default
* **[Breaking Change]** Replace cpu entitlement counters with cpu_entitlement percentage gauge
* **[Breaking Change]** Remove (deprecated) Metrics Agent and Metrics Discovery Release
* **[Breaking Change]**: Move and adapt UAA password complexity policies 
* **[Breaking Change]**: Remove ability of UAA to serve as a native SAML identity provider (operators can continue to configure UAA to connect to an external SAML identity provider, using the **Authentication and Enterprise SSO** pane of the <%= vars.app_runtime_abbr %> tile configuration)
* **[Breaking Change]** Gorouter's deprecated /varz and /healthz endpoints on port 8080 have been removed
* **[Feature]** New form option and migration to opt-into allowing Small Footprint TAS to 'full' TAS upgrade.
* **[Feature]** Add support for NTLM authentication in Gorouter
* **[Feature]** CAPI Enable legacy MD5 buildpack paths
* **[Feature]** Adds Diego support for Docker workloads using OCI images
* **[Feature]**: Gorouters can be configured to prefer routing to app instances in the same AZ as the router
* **[Feature]** Operators can now turn off non-TLS load balancer health check endpoints for Gorouter and TCP Router via the "Enable HTTP load balancer health checks" properties in the "Networking" tab
* **[Feature]** dopplers can be scaled to zero
* **[Feature]** Gorouter now supports LB Health Checks over TLS on port 8443
* **[Feature]** Operators can set the property "Maximum number of network policies per app source" in the "App Developer Controls"
* **[Feature]** CF API now includes routability status from App Readiness checks in the /processes/:id/stats endpoint.
* **[Feature]** Expose a custom environment identifier on component logs forwarded via syslog
* **[Feature]** Advanced Configuration: Do not deploy Diego cells
* **[Feature Improvement]** Make database "encrypt key" setting more intentional, to avoid password-manager autofilling of the field
* **[Feature Improvement]** Reintroduce global log rate limit
* **[Feature Improvement]** OTel Collector marks OTLP Sums as monotonic if they originate from a Loggregator counter
* **[Feature Improvement]** Stop logging out of external OIDC provider when logging out of TAS
* **[Feature Improvement]** Operators can select which protocols Routing API will accept via the "Routing API Endpoint Protocol" property in the Networking tab. This property defaults to the backwards compatible option "both" that works with all tile integrations.
* **[Feature Improvement]**  Allow to configure w3c tracing headers in router
* **[Feature Improvement]** [Cloud Controller] Add option to configure Instance File Descriptor Limit
* **[Feature Improvement]** Apps using readiness health checks will now see audit.app.process.notready and audit.app.process.ready events reported to `cf events`
* **[Feature Improvement]** Garden now emits an `UnkillableContainers` metric to help identify cells that will be unable to redeploy successfully without operator intervention
* **[Feature Improvement]** Adds opt-in support for NTLM + other challenge-response based authentication using `Authorization: Negotiate` flows by automatically enabling sticky sessions for those requests.
* **[Feature Improvement]** Adds support for `Partitioned` cookies to allow for sticky sessions in embedded contexts.

<table border="1" class="nice">
  <thead>
    <tr>
      <th>Component</th>
      <th>Version</th>
      <th>Release Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>ubuntu-jammy stemcell</td><td>1.406</td><td></td></tr>
    <tr><td>backup-and-restore-sdk</td><td>1.19.8</td>
      <td>
        <details>
          <summary>v1.19.8</summary>
          <pre style="max-width: 30em">
  ## Dependencies
  * **v2:** Updated to v2.17.0.<br>For more information, see [v2](https://github.com/onsi/ginkgo).
  * **gomega:** Updated to v1.32.0.<br>For more information, see [gomega](https://github.com/onsi/gomega).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>binary-offline-buildpack</td><td>1.1.10</td><td></td></tr>
    <tr><td>bosh-dns-aliases</td><td>0.0.4</td><td></td></tr>
    <tr><td>bpm</td><td>1.2.17</td><td></td></tr>
    <tr><td>capi</td><td>1.175.0</td><td></td></tr>
    <tr><td>cf-autoscaling</td><td>250.2.2</td>
      <td>
        <details>
          <summary>v250.2.2</summary>
          <pre style="max-width: 30em">
  ## What's Changed
  * Bump dependencies
  **Full Changelog**: https://github.com/pivotal-cf/cf-autoscaling-release/compare/v250.2.2...v250.2.2
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>cf-cli</td><td>1.60.0</td><td></td></tr>
    <tr><td>cf-networking</td><td>3.45.0</td>
      <td>
        <details>
          <summary>v3.45.0</summary>
          <pre style="max-width: 30em">
  ## Changes
  - Go dependency bumps
  - Added config for staticcheck
  - Removed references to consul from documentation
  ## Bosh Job Spec changes:
  ```diff
  diff --git a/jobs/policy-server-asg-syncer/spec b/jobs/policy-server-asg-syncer/spec
  index 748c39a7..4c6c9a4e 100644
  --- a/jobs/policy-server-asg-syncer/spec
  +++ b/jobs/policy-server-asg-syncer/spec
  @@ -109,7 +109,7 @@ properties:
  description: "Trusted CA for UAA server."
  uaa_hostname:
  -    description: "Host name for the UAA server.  E.g. the service advertised via Consul DNS.  Must match common name in the UAA server cert. Must be listed in `uaa.zones.internal.hostnames`."
  +    description: "Host name for the UAA server.  E.g. the service advertised via Bosh DNS.  Must match common name in the UAA server cert. Must be listed in `uaa.zones.internal.hostnames`."
  default: uaa.service.cf.internal
  uaa_port:
  diff --git a/jobs/policy-server-internal/spec b/jobs/policy-server-internal/spec
  index 7095775d..029e723f 100644
  --- a/jobs/policy-server-internal/spec
  +++ b/jobs/policy-server-internal/spec
  @@ -41,7 +41,7 @@ properties:
  default: 31946
  health_check_timeout_seconds:
  -    description: "Health check timeout for Consul DNS."
  +    description: "Health check timeout"
  default: 5
  internal_listen_port:
  @@ -52,7 +52,7 @@ properties:
  description: "Trusted CA certificate that was used to sign the vxlan policy agent's client cert and key."
  server_cert:
  -    description: "Server certificate for TLS. Must have common name that matches the Consul DNS name of the policy server, eg `policy-server.service.cf.internal`."
  +    description: "Server certificate for TLS. Must have common name that matches the Bosh DNS name of the policy server, eg `policy-server.service.cf.internal`."
  server_key:
  description: "Server key for TLS."
  diff --git a/jobs/policy-server/spec b/jobs/policy-server/spec
  index 0d9f5157..8e2ccfa8 100644
  --- a/jobs/policy-server/spec
  +++ b/jobs/policy-server/spec
  @@ -101,7 +101,7 @@ properties:
  description: "Trusted CA for UAA server."
  uaa_hostname:
  -    description: "Host name for the UAA server.  E.g. the service advertised via Consul DNS.  Must match common name in the UAA server cert. Must be listed in `uaa.zones.internal.hostnames`."
  +    description: "Host name for the UAA server.  E.g. the service advertised via Bosh DNS.  Must match common name in the UAA server cert. Must be listed in `uaa.zones.internal.hostnames`."
  default: uaa.service.cf.internal
  uaa_port:
  ```
  ## ✨  Built with go 1.21.8
  **Full Changelog**: https://github.com/cloudfoundry/cf-networking-release/compare/v3.44.0...v3.45.0
  ## Resources
  - [Download release 3.45.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/cf-networking-release?version=3.45.0).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>cflinuxfs3</td><td>0.387.0</td><td></td></tr>
    <tr><td>cflinuxfs4</td><td>1.82.0</td><td></td></tr>
    <tr><td>count-cores-indicator</td><td>2.0.0</td><td></td></tr>
    <tr><td>credhub</td><td>2.12.66</td><td></td></tr>
    <tr><td>diego</td><td>2.96.0</td>
      <td>
        <details>
          <summary>v2.96.0</summary>
          <pre style="max-width: 30em">
  ## Changes
  - Bump to golang 1.21.8
  - Golang package dependency bumps
  - Includes moving from docker v20 to docker v26
  - Includes moving from pgx v3 to pgx v5
  - Remove references to Consul from boshrelease + documentation
  - Many fixes to remove deprecated code and otherwise fix linter violations.
  ## ✨  Built with go 1.21.8
  **Full Changelog**: https://github.com/cloudfoundry/diego-release/compare/v2.95.0...v2.96.0
  ## Resources
  - [Download release 2.96.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/diego-release?version=2.96.0).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>dotnet-core-offline-buildpack</td><td>2.4.26</td><td></td></tr>
    <tr><td>garden-runc</td><td>1.51.0</td>
      <td>
        <details>
          <summary>v1.51.0</summary>
          <pre style="max-width: 30em">
  ## Changes
  - Bumped Golang to 1.21.8
  - Golang package dependency bumps
  - Many updates to get codebase passing the staticcheck linker
  - Updated garden-integration-tests to be a little less flakey
  ## ✨  Built with go 1.21.8
  **Full Changelog**: https://github.com/cloudfoundry/garden-runc-release/compare/v1.50.0...v1.51.0
  ## Resources
  - [Download release 1.51.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/garden-runc-release?version=1.51.0).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>go-offline-buildpack</td><td>1.10.17</td><td></td></tr>
    <tr><td>java-offline-buildpack</td><td>4.67.1</td><td></td></tr>
    <tr><td>java-native-image-cnb-buildpack</td><td>0.10.0</td>
      <td>
        <details>
          <summary>0.10.0</summary>
          <pre style="max-width: 30em">
  Components:
  * [buildpack v0.12.0](https://github.com/pivotal-cf/java-native-image-cnb-buildpack/releases/tag/v0.12.0)
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>log-cache</td><td>3.0.11</td><td></td></tr>
    <tr><td>loggregator</td><td>107.0.13</td><td></td></tr>
    <tr><td>loggregator-agent</td><td>8.0.2</td><td></td></tr>
    <tr><td>mapfs</td><td>1.2.63</td>
      <td>
        <details>
          <summary>v1.2.63</summary>
          <pre style="max-width: 30em">
  ## Dependencies
  * **v2:** Updated to v2.17.0.<br>For more information, see [v2](https://github.com/onsi/ginkgo).
  * **mapfs:** Updated to v`5381efc`.<br>For more information, see [mapfs](https://github.com/cloudfoundry/mapfs).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>metric-registrar</td><td>3.0.2</td><td></td></tr>
    <tr><td>mysql-monitoring</td><td>10.12.0</td>
      <td>
        <details>
          <summary>v10.12.0</summary>
          <pre style="max-width: 30em">
  - Updates golang to 1.22.1
  - Updates packages and dependencies
  - #186647418 - mysql-diag should report cluster status and disk metrics more concisely
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>nats</td><td>56.15.0</td><td></td></tr>
    <tr><td>nfs-volume</td><td>7.1.59</td>
      <td>
        <details>
          <summary>v7.1.59</summary>
          <pre style="max-width: 30em">
  ## Changes
  * Bump util-linux from 2.39.3 to 2.40 (#853)
  ## Dependencies
  * **nfsbroker:** Updated to v`7bc7bb0`.<br>For more information, see [nfsbroker](https://github.com/cloudfoundry/nfsbroker).
  * **nfsv3driver:** Updated to v`15c152b`.<br>For more information, see [nfsv3driver](https://github.com/cloudfoundry/nfsv3driver).
          </pre>
        </details>
        <details>
          <summary>v7.1.58</summary>
          <pre style="max-width: 30em">
  ## Dependencies
  * **nfsbroker:** Updated to v`e850d95`.<br>For more information, see [nfsbroker](https://github.com/cloudfoundry/nfsbroker).
  * **nfsv3driver:** Updated to v`8af81b5`.<br>For more information, see [nfsv3driver](https://github.com/cloudfoundry/nfsv3driver).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>nginx-offline-buildpack</td><td>1.2.12</td><td></td></tr>
    <tr><td>nodejs-offline-buildpack</td><td>1.8.23</td><td></td></tr>
    <tr><td>notifications</td><td>69.0.0</td><td></td></tr>
    <tr><td>notifications-ui</td><td>47.0.0</td><td></td></tr>
    <tr><td>otel-collector</td><td>0.4.0</td><td></td></tr>
    <tr><td>php-offline-buildpack</td><td>4.6.17</td><td></td></tr>
    <tr><td>push-apps-manager-release</td><td>677.0.41</td><td></td></tr>
    <tr><td>push-offline-docs-release</td><td>6.0.169</td><td></td></tr>
    <tr><td>push-usage-service-release</td><td>674.0.94</td>
      <td>
        <details>
          <summary>v674.0.94</summary>
          <pre style="max-width: 30em">
  ## Dependencies
  * **app-usage-service:** Updated to v`9af4b6b`.<br>For more information, see [app-usage-service](https://github.com/pivotal-cf/app-usage-service).
          </pre>
        </details>
        <details>
          <summary>v674.0.93</summary>
          <pre style="max-width: 30em">
  ## Changes
  ## Dependencies
  * **app-usage-service:** Updated to v`4c2a77a`.<br>For more information, see [app-usage-service](https://github.com/pivotal-cf/app-usage-service).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>pxc</td><td>1.0.25</td>
      <td>
        <details>
          <summary>v1.0.25</summary>
          <pre style="max-width: 30em">
  - Updates golang to 1.22.1
  - Modifies bootstrap errand behavior; bootstrap now only executes on a single pxc node, removing the need for the user to designate the specific node for execution.
  - Introduces property `engine_config.log_slow_verbosity` increasing the information reported in slow query logs
  - Updates packages and dependencies
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>python-offline-buildpack</td><td>1.8.22</td><td></td></tr>
    <tr><td>r-offline-buildpack</td><td>1.2.10</td><td></td></tr>
    <tr><td>routing</td><td>0.295.0</td>
      <td>
        <details>
          <summary>v0.295.0</summary>
          <pre style="max-width: 30em">
  ## Changes
  - Resolves #401 by reverting the removal of the deprecated BuildNameToCertificate() call
  - Bumps to golang 1.21.9 + golang.org/x/net 0.23.0 to patch CVE-2023-45288
  ## ✨  Built with go 1.21.9
  **Full Changelog**: https://github.com/cloudfoundry/routing-release/compare/v0.294.0...v0.295.0
  ## Resources
  - [Download release 0.295.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/routing-release?version=0.295.0).
          </pre>
        </details>
        <details>
          <summary>v0.294.0</summary>
          <pre style="max-width: 30em">
  ⚠️ This release contains a known issue: gorouter will no longer present the most specific certificate match but rather the first certificate that matches. See https://github.com/cloudfoundry/routing-release/issues/401 for details. Upgrading to routing-release 0.295.0 is advised. ⚠️
  ## Changes
  - [Bump haproxy to 2.8.7](https://github.com/cloudfoundry/routing-release/commit/13b39eb5185656c3557c1ab15b5b13752b2ff6d8)
  - [update templates to not refer to consul](https://github.com/cloudfoundry/routing-release/commit/8216c056b1463bd1d7bf636a749568f70cb924d2)
  - [Default the routing_api.enabled_api_endpoints to mtls](https://github.com/cloudfoundry/routing-release/commit/2e96c2c932f7f945c3c7c15a768d0affc80de446)
  - [Update template test for mTLS routing api default](https://github.com/cloudfoundry/routing-release/commit/469d9e0a4eb0ac6015695ba27c6da80576b29801)
  - [Upgrade cf-cli-8-linux](https://github.com/cloudfoundry/routing-release/commit/b19a25052ed7982c83524ac87d22ed2f316201a2)
  ## Bosh Job Spec changes:
  ```diff
  diff --git a/jobs/routing-api/spec b/jobs/routing-api/spec
  index 1d7efe3c..2e5cd361 100644
  --- a/jobs/routing-api/spec
  +++ b/jobs/routing-api/spec
  @@ -95,7 +95,7 @@ properties:
  routing_api.enabled_api_endpoints:
  description: "Protocols that the routing api will listen on. Possible values: 'mtls', or 'both' (mTLS + HTTP)"
  -    default: "both"
  +    default: "mtls"
  routing_api.mtls_port:
  description: "Port on which Routing API is running, listening with mTLS."
  default: 3001
  ```
  ## ✨  Built with go 1.21.8
  **Full Changelog**: https://github.com/cloudfoundry/routing-release/compare/v0.293.0...v0.294.0
  ## Resources
  - [Download release 0.294.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/routing-release?version=0.294.0).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>ruby-offline-buildpack</td><td>1.10.11</td><td></td></tr>
    <tr><td>web-servers-cnb-buildpack</td><td>0.11.0</td><td></td></tr>
    <tr><td>silk</td><td>3.45.0</td>
      <td>
        <details>
          <summary>v3.45.0</summary>
          <pre style="max-width: 30em">
  ## Changes
  - Fixes to stop using deprecated code in tests (`net.Error.Temporary()`)
  - Remove consul references from documentation
  - Fix issues bumping the code.cloudfoundry.org/executor package
  - Go package bumps
  ## Bosh Job Spec changes:
  ```diff
  diff --git a/jobs/silk-controller/spec b/jobs/silk-controller/spec
  index a0966a01..cc7529a8 100644
  --- a/jobs/silk-controller/spec
  +++ b/jobs/silk-controller/spec
  @@ -45,11 +45,11 @@ properties:
  default: 46455
  health_check_port:
  -    description: "Health check port for silk controller. Used by the Consul DNS health check."
  +    description: "Health check port for silk controller. Used by the Bosh DNS health check."
  default: 19683
  health_check_timeout_seconds:
  -    description: "Health check timeout for Consul DNS."
  +    description: "Health check timeout"
  default: 5
  listen_ip:
  @@ -64,7 +64,7 @@ properties:
  description: "Trusted CA certificate that was used to sign the silk daemon client cert and key."
  server_cert:
  -    description: "Server certificate for TLS. Must have common name that matches the Consul DNS name of the silk controller, eg silk-controller.service.cf.internal"
  +    description: "Server certificate for TLS. Must have common name that matches the Bosh DNS name of the silk controller, eg silk-controller.service.cf.internal"
  server_key:
  description: "Server key for TLS."
  diff --git a/jobs/silk-daemon/spec b/jobs/silk-daemon/spec
  index 7a1525b3..e3786357 100644
  --- a/jobs/silk-daemon/spec
  +++ b/jobs/silk-daemon/spec
  @@ -70,7 +70,7 @@ properties:
  default: 3457
  silk_controller.hostname:
  -    description: "Host name for the silk controller.  E.g. the service advertised via Consul DNS.  Must match common name in the silk_controller.server_cert"
  +    description: "Host name for the silk controller.  E.g. the service advertised via Bosh DNS.  Must match common name in the silk_controller.server_cert"
  default: "silk-controller.service.cf.internal"
  silk_controller.listen_port:
  diff --git a/jobs/vxlan-policy-agent/spec b/jobs/vxlan-policy-agent/spec
  index 3118022b..802f04bb 100644
  --- a/jobs/vxlan-policy-agent/spec
  +++ b/jobs/vxlan-policy-agent/spec
  @@ -41,7 +41,7 @@ properties:
  default: false
  policy_server.hostname:
  -    description: "Host name for the policy server.  E.g. the service advertised via Consul DNS.  Must match common name in the policy_server.server_cert"
  +    description: "Host name for the policy server.  E.g. the service advertised via Bosh DNS.  Must match common name in the policy_server.server_cert"
  default: "policy-server.service.cf.internal"
  policy_server.internal_listen_port:
  ```
  ## ✨  Built with go 1.21.8
  **Full Changelog**: https://github.com/cloudfoundry/silk-release/compare/v3.44.0...v3.45.0
  ## Resources
  - [Download release 3.45.0 from bosh.io](https://bosh.io/releases/github.com/cloudfoundry/silk-release?version=3.45.0).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>smb-volume</td><td>3.1.61</td>
      <td>
        <details>
          <summary>v3.1.61</summary>
          <pre style="max-width: 30em">
  ## Dependencies
  * **v2:** Updated to v2.17.0.<br>For more information, see [v2](https://github.com/onsi/ginkgo).
  * **gomega:** Updated to v1.32.0.<br>For more information, see [gomega](https://github.com/onsi/gomega).
  * **smbbroker:** Updated to v`bab4864`.<br>For more information, see [smbbroker](https://github.com/cloudfoundry/smbbroker).
  * **smbdriver:** Updated to v`7f3242d`.<br>For more information, see [smbdriver](https://github.com/cloudfoundry/smbdriver).
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>smoke-tests</td><td>4.8.5</td><td></td></tr>
    <tr><td>staticfile-offline-buildpack</td><td>1.6.11</td><td></td></tr>
    <tr><td>statsd-injector</td><td>1.11.39</td><td></td></tr>
    <tr><td>syslog</td><td>12.2.3</td><td></td></tr>
    <tr><td>system-metrics-scraper</td><td>4.0.7</td><td></td></tr>
    <tr><td>uaa</td><td>77.4.0</td>
      <td>
        <details>
          <summary>v77.4.0</summary>
          <pre style="max-width: 30em">
  ## What's Changed
  ### New UAA
  * Bump to [UAA v77.4.0](https://github.com/cloudfoundry/uaa/releases/tag/v77.4.0)
  ### Dependency Bumps
  * Bump github.com/cloudfoundry/bosh-utils from 0.0.452 to 0.0.453 in /src/acceptance_tests by @dependabot in https://github.com/cloudfoundry/uaa-release/pull/834
  **Full Changelog**: https://github.com/cloudfoundry/uaa-release/compare/v77.3.0...v77.4.0
          </pre>
        </details>
      </td>
    </tr>
    <tr><td>tanzu-jammy-stack</td><td>1.0.1</td><td></td></tr>
  </tbody>
</table>



## <a id='new-features'></a> New features in <%= vars.app_runtime_full %> <%= vars.v_major_version %>

These are the new features for <%= vars.app_runtime_full %> <%= vars.v_major_version %>.

### Reduced logging and metric infrastructure requirements

If you do not use the legacy V1 and V2 Loggregator Firehoses, you now can scale Doppler and Traffic Controller VMs down to zero. This can
significantly reduce costs or free up resources for running additional workloads on the platform.
You might not be able to scale down to zero if you use integrations or other features that depend on the Firehose, such as log and metric nozzles or
Metric Registrar.

### Reintroduction of global log rate limit

<%= vars.app_runtime_abbr %> v3.0 introduced granular app log rate limits for fine-grained control over application log rates.

<%= vars.app_runtime_abbr %> v4.0 removed the older global log rate limit feature **App log rate limit (deprecated)** under **App Containers**. This was problematic for operators who were performing a jump upgrade to <%= vars.app_runtime_abbr %> v4.0 (skipping v3.0), as logs
would not be rate limited until application-based log rate limits were applied.

<%= vars.app_runtime_abbr %> <%= vars.v_major_version %> restores the global log rate limit, so that operators can perform upgrades while retaining log rate limits. Operators
must configure the same setting separately for both <%= vars.segment_runtime_full %> and <%= vars.windows_runtime_abbr %>.

If you had previously set a global log rate limit, this limit is re-applied following the upgrade to
<%= vars.app_runtime_full %> <%= vars.v_major_version %>.

### App Autoscaler supports scaling on CPU entitlement

<%= vars.app_runtime_full %> <%= vars.v_major_version %> introduces support for autoscaling on CPU entitlement. This
improves App Autoscaler support for scaling on CPU. Previously, App Autoscaler CPU rules could be brittle due to
their dependency on the underlying Diego Cell configuration. With this feature, apps can autoscale on the CPU
entitlement available, calculated appropriately based on the memory allocated.

## <a id='breaking-changes'></a> Breaking changes

These are the breaking changes for <%= vars.app_runtime_full %> <%= vars.v_major_version %>.

### Default stacks no longer include cflinuxfs3

New installations of <%= vars.app_runtime_abbr %> <%= vars.v_major_version %> no longer default to include cflinuxfs3 in the list of stacks.
Operators can continue to [configure <%= vars.app_runtime_abbr %>](https://docs.vmware.com/en/VMware-Tanzu-Application-Service/<%= vars.current_major_version %>/tas-for-vms/config-cloud-controller.html)
to install cflinuxfs3, if desired.

Upgrading an existing foundation to <%= vars.app_runtime_abbr %> <%= vars.v_major_version %> does not remove cflinuxfs3.
Apps running on cflinuxfs3 continue to run as normal, and developers can continue to push applications using the cflinuxfs3 stack.
However, if operators [remove cflinuxfs3](https://docs.vmware.com/en/VMware-Tanzu-Application-Service/<%= vars.current_major_version %>/tas-for-vms/stack-auditor.html)
from an existing foundation,
then cflinuxfs3 is no longer installed when deploying <%= vars.app_runtime_abbr %>,
unless the default stack list is configured to include cflinuxfs3 (see above).

Support for the cflinuxfs3 stack is deprecated and will be removed in a future release of <%= vars.app_runtime_abbr %>.
If you have not already, migrate all applications off of cflinuxfs3 and remove the stack from your foundations.

### Absolute CPU Entitlement metrics no longer available

The `absolute_entitlement` and `absolute_usage` metrics are no longer emitted for each container. They are replaced by the `cpu_entitlement`
metric. If you have any dashboards that reference the `absolute_entitlement` and `absolute_usage` metrics, update the dashboards to use the new metric.

Due to the removal of these metrics, the experimental CPU Entitlement Plug-in no longer functions. If you use this plug-in to view
CPU entitlement usage, you can instead view the `cpu_entitlement` metric, for example using the Log Cache cf CLI plug-in.

## <a id='known-issues'></a> Known issues

Here are the known issues for <%= vars.app_runtime_full %> <%= vars.v_major_version %>.

### Loggregator Agents in other products may log failure when Dopplers are scaled to zero

Service tile products can use Loggregator Agent to egress metrics for service instances. If the Doppler instance group is scaled to zero,
then Loggregator Agent jobs deployed by these products may repeatedly log a failure to connect to Doppler:

```
failed to connect: unable to lookup a log consumer
```
